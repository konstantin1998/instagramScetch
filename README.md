Применить CQRS к сервису инстаграм подразумевает написание отдельных классов для запросов и команд. С учетом того, что мы работаем только с базовыми сущностями команды будут следуюшие:
 1. Запостить
 2. Прокомментировать
 3. Лайкнуть

запросы будут следующего вида:
1. Получить все посты по заданному id. Обычно можно посмотреть посты можно у какого-то аккаунта или на каком-то канале. В данном коде посты можно получить по строковому id, чтобы не вводить лишних сущностей типа каналов или аккаунтов.
2. Получить все комментарии под данным постом
3. Получить все лайки под данным постом или комментарием

С учетом того, что запросов на чтение гораздо больше запросов на публикацию, надо оптимизировать read-model, чтобы запросы выполнялись побыстрее. Для этого read-model реализована через 3 класса: CommentStorage, PostStorage, LikeStorage. Они все устроены следующим образом: внутри себя они содержат HashMap, в которой значением является ArrayList<Post> или ArrayList<Comment>, ArrayList<Like>. При выполнении команд туда добавляются новые элементы, при выполнении запросов возвращаются эти списки.

Все команды устроены следующим образом: в конструкторе принимают ссылку на Storage, ссылку на ключ, по которому надо положить элемент в Storage и сам элемент, который надо добавить в Storage. При выполнении метода execute команда кладет элемент в Storage.

Все запросы устроены следующим образом: в конструкторе принимают ссылку на Storage и ссылку на элемент по которому надо сделать выборку. При выполнении метода select возвращаются результаты выборки.


